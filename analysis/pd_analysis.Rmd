---
title: "Prey Delivery Analysis"
author: "Eliza Stein"
date: "11/8/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

##Next step is to convert times to numeric and then set xlim to 240

##Libraries

```{r}
library(tidyverse)
```



##Load data

```{r}



pdOriginal <- read.csv("~/final-project/data/pd_main.csv")


#rename the first column, which imported with a special character
names(pdOriginal)[1] <- "nest"


```



##Tidy data

Filter to only include males in B (Missori) and C (Hayman)
```{r}

pdHayMissou <- pdOriginal %>%
  separate(col = nest, into = c("study_site", "territory"), sep = 1, remove = TRUE) %>%
  filter(study_site == "B" | study_site == "C", sex == "M")

```

Check structure of data
```{r}

str(pdHayMissou) #columns 't180' and 't225' are character classes

unique(pdHayMissou$t180) #at least one cell has an asterisk after the value
unique(pdHayMissou$t225) #same here

#remove asterisks
pdClean <- pdHayMissou %>%
  mutate(t180 = gsub("\\*", "", t180)) %>%
  mutate(t225 = gsub("\\*", "", t225))

#change these columns to integers
pdClean$t180 <- as.integer(pdClean$t180)
pdClean$t225 <- as.integer(pdClean$t225)

```

Aggregate by study site mean
```{r}
#create independet dfs for Hayman and Missouri
pdHay <- filter(pdClean, study_site == "C")
pdMiss <- filter(pdClean, study_site =="B")

#bind only time observations for each study site
bindHay <- cbind(study_site = "Hayman", pdHay[12:47])
bindMiss <- cbind(study_site = "Missouri", pdMiss[12:47])

#take column means of new dfs
meanHay <- colMeans(bindHay, na.rm = TRUE)
meanMiss <- colMeans(bindMiss, na.rm = TRUE)

#create new transposed df with means for Hayman and Missouri
meanHayMiss<- as.matrix(t(cbind(meanHay, meanMiss)))


```

Below is a data.frame of pds for Hayman and Missouri, grouped by "study_site"
```{r}


pdHayMiss <- rbind(bindHay, bindMiss)

```

##Plot mean prey deliveries

```{r}

meanPlot <- barplot(
  meanHayMiss, 
  beside = TRUE, 
  legend.text = TRUE, 
  col = c("red", "blue"),
  ylim = c(0, 3)
)

```
