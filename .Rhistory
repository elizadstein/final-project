?raster
# Data manipulation and visualization
install.packages("tidyverse", repos='http://cran.us.r-project.org')
install.packages("gridExtra", repos='http://cran.us.r-project.org')
# Data manipulation and visualization
library(tidyverse)
library(gridExtra)
# Data manipulation and visualization
install.packages("tidyverse", repos='http://cran.us.r-project.org')
install.packages("gridExtra", repos='http://cran.us.r-project.org')
install.packages("gridExtra", repos = "http://cran.us.r-project.org")
# Data manipulation and visualization
install.packages("tidyverse", repos='http://cran.us.r-project.org')
# Data manipulation and visualization
install.packages("tidyverse", repos='http://cran.us.r-project.org')
install.packages("gridExtra", repos='http://cran.us.r-project.org')
install.packages("gridExtra", repos = "http://cran.us.r-project.org")
# Spatial data analysis
install.packages("sp", repos=c('http://R-Forge.R-project.org', 'http://cran.rstudio.com'))
install.packages("raster", repos='http://cran.us.r-project.org')
# Data manipulation and visualization
library(tidyverse)
library(gridExtra)
library(raster)
#' getCI
#'
#' @param vec a vector
#' @param n_samp number of times to sample data
#'
#' @return upper and lower bootstrap confidence intervals
#'
#'
#' @examples
#'    getCI(1:20, 1000)
#' @export
getCI <- function(vec, n_samp=10000) {
smp <- replicate(n_samp, mean(sample(vec, replace = TRUE), na.rm = TRUE))
CIs <-quantile(smp, c(0.025, 0.975), na.rm = T)
return(CIs)
}
sessionInfo()
# Load raster image
severity <- raster("./analysis/images/burn_severity/burn_severity.adf")
pdOriginal <- read.csv("./data/pd_main.csv")
#rename the first column, which imported with a special character
names(pdOriginal)[1] <- "nest"
pdOriginal <- read.csv("./fiinal-project/data/pd_main.csv")
pdOriginal <- read.csv("./final-project/data/pd_main.csv")
setwd("~fialproject")
setwd("~final-project")
setwd("~/final-project")
pdOriginal <- read.csv("./data/pd_main.csv")
#rename the first column, which imported with a special character
names(pdOriginal)[1] <- "nest"
pdMF <- pdOriginal %>%
separate(col = nest, into = c("study_site", "territory"), sep = 1, remove = TRUE) %>%
filter(sex == "M" | sex == "F")
str(pdMF)
unique(pdMF$t180) #at least one cell has an asterisk after the value
unique(pdMF$t225) #same here
unique(pdMF$nest_age) #"pred" and "" can be converted to NA
#remove asterisks
pdClean <- pdMF %>%
mutate(t180 = gsub("\\*", "", t180)) %>%
mutate(t225 = gsub("\\*", "", t225))
#change these columns to numeric
pdClean$t180 <- as.integer(pdClean$t180)
pdClean$t225 <- as.integer(pdClean$t225)
pdClean$nest_age <- as.integer(pdClean$nest_age) #warning here is ok--NAs are replacing "pred" and "" values
# Create independent dfs for M (nestling and incubation stage) and F (nestling and incubation state).
#select relevant columns, add column for stage, rename study sites, drop NAs
pdStage1 <- pdClean %>%
dplyr::select(sex, nest_age, t15:t240) %>%
mutate(
stage =
ifelse(nest_age < 22, "incubation", "nestling")) %>%
drop_na(stage)
#change column names to remove "t" in front of time interval
colnames(pdStage1) <- c("sex", "nest_age", "15", "30", "45", "60", "75", "90", "105", "120", "135", "150", "165", "180", "195", "210", "225", "240", "stage")
#create independent dfs for each study site and stage
pdM_inc <- pdStage1 %>%
filter(sex =="M", stage == "incubation") %>%
dplyr::select('15':'240')
pdM_nest <- pdStage1 %>%
filter(sex =="M", stage == "nestling") %>%
dplyr::select('15':'240')
pdF_inc <- pdStage1 %>%
filter(sex =="F", stage == "incubation") %>%
dplyr::select('15':'240')
pdF_nest <- pdStage1 %>%
filter(sex =="F", stage == "nestling") %>%
dplyr::select('15':'240')
meanM_inc <- data.frame(
time = as.numeric(colnames(pdM_inc)),
M_incubation = colMeans(pdM_inc, na.rm = TRUE))
meanM_nest <- data.frame(
time = as.numeric(colnames(pdM_nest)),
M_nestling = colMeans(pdM_nest, na.rm = TRUE))
meanF_inc <- data.frame(
time = as.numeric(colnames(pdF_inc)),
F_incubation = colMeans(pdF_inc, na.rm = TRUE))
meanF_nest <- data.frame(
time = as.numeric(colnames(pdF_nest)),
F_nestling = colMeans(pdF_nest, na.rm = TRUE))
meanMF <- data.frame(
time = as.numeric(colnames(pdM_inc)),
M_incubation = colMeans(pdM_inc, na.rm = TRUE),
M_nestling = colMeans(pdM_nest, na.rm = TRUE),
F_incubation = colMeans(pdF_inc, na.rm = TRUE),
F_nestling = colMeans(pdF_nest, na.rm = TRUE)
)
install.packages("pandoc")
install.packages("pandoc", repos='http://cran.us.r-project.org')
library(pandoc)
meanAll <- data.frame(
time = as.numeric(colnames(pdHFSA_inc)),
HFSA_incubation = colMeans(pdHFSA_inc, na.rm = TRUE),
HFSA_nestling = colMeans(pdHFSA_nest, na.rm = TRUE),
MGSA_incubation = colMeans(pdMGSA_inc, na.rm = TRUE),
MGSA_nestling = colMeans(pdMGSA_nest, na.rm = TRUE)
)
# Chunk 10
pdOriginal <- read.csv("./data/pd_main.csv")
#rename the first column, which imported with a special character
names(pdOriginal)[1] <- "nest"
# Chunk 11
pdMF <- pdOriginal %>%
separate(col = nest, into = c("study_site", "territory"), sep = 1, remove = TRUE) %>%
filter(sex == "M" | sex == "F")
# Chunk 12
str(pdMF)
unique(pdMF$t180) #at least one cell has an asterisk after the value
unique(pdMF$t225) #same here
unique(pdMF$nest_age) #"pred" and "" can be converted to NA
# Chunk 13
#remove asterisks
pdClean <- pdMF %>%
mutate(t180 = gsub("\\*", "", t180)) %>%
mutate(t225 = gsub("\\*", "", t225))
#change these columns to numeric
pdClean$t180 <- as.integer(pdClean$t180)
pdClean$t225 <- as.integer(pdClean$t225)
pdClean$nest_age <- as.integer(pdClean$nest_age)
#warning here is ok--NAs are replacing "pred" and "" values
# Chunk 14
# Create independent dfs for M (nestling and incubation stage) and F (nestling and incubation state).
#select relevant columns, add column for stage, rename study sites, drop NAs
pdStage1 <- pdClean %>%
dplyr::select(sex, nest_age, t15:t240) %>%
mutate(
stage =
ifelse(nest_age < 22, "incubation", "nestling")) %>%
drop_na(stage)
#change column names to remove "t" in front of time interval
colnames(pdStage1) <- c("sex", "nest_age", "15", "30", "45", "60", "75", "90", "105", "120", "135", "150", "165", "180", "195", "210", "225", "240", "stage")
#create independent dfs for each study site and stage
pdM_inc <- pdStage1 %>%
filter(sex =="M", stage == "incubation") %>%
dplyr::select('15':'240')
pdM_nest <- pdStage1 %>%
filter(sex =="M", stage == "nestling") %>%
dplyr::select('15':'240')
pdF_inc <- pdStage1 %>%
filter(sex =="F", stage == "incubation") %>%
dplyr::select('15':'240')
pdF_nest <- pdStage1 %>%
filter(sex =="F", stage == "nestling") %>%
dplyr::select('15':'240')
# Chunk 15
meanM_inc <- data.frame(
time = as.numeric(colnames(pdM_inc)),
M_incubation = colMeans(pdM_inc, na.rm = TRUE))
meanM_nest <- data.frame(
time = as.numeric(colnames(pdM_nest)),
M_nestling = colMeans(pdM_nest, na.rm = TRUE))
meanF_inc <- data.frame(
time = as.numeric(colnames(pdF_inc)),
F_incubation = colMeans(pdF_inc, na.rm = TRUE))
meanF_nest <- data.frame(
time = as.numeric(colnames(pdF_nest)),
F_nestling = colMeans(pdF_nest, na.rm = TRUE))
# Chunk 16
meanMF <- data.frame(
time = as.numeric(colnames(pdM_inc)),
M_incubation = colMeans(pdM_inc, na.rm = TRUE),
M_nestling = colMeans(pdM_nest, na.rm = TRUE),
F_incubation = colMeans(pdF_inc, na.rm = TRUE),
F_nestling = colMeans(pdF_nest, na.rm = TRUE)
)
# Chunk 17
#now apply it across the columns of PD data
ciM_inc <- apply(pdM_inc, 2, FUN = getCI)
ciM_nest <- apply(pdM_nest, 2, FUN = getCI)
ciF_inc <- apply(pdF_inc, 2, FUN = getCI)
ciF_nest <- apply(pdF_nest, 2, FUN = getCI)
# Chunk 18
ciInc_sex <- data.frame(
sex = c(rep("M", nrow(meanM_inc)), rep("F", nrow(meanF_inc))),
mean = c(colMeans(pdM_inc, na.rm = TRUE), colMeans(pdF_inc, na.rm = TRUE)),
ci_l = c(ciM_inc[1,], ciF_inc[1,]),
ci_h = c(ciM_inc[2,], ciF_inc[2,]),
time = c(as.numeric(rownames(meanM_inc)), as.numeric(rownames(meanF_inc))),
stage = "Incubation")
ciNest_sex <- data.frame(
sex = c(rep("M", nrow(meanM_nest)), rep("F", nrow(meanF_nest))),
mean = c(colMeans(pdM_nest, na.rm = TRUE), colMeans(pdF_nest, na.rm = TRUE)),
ci_l = c(ciM_nest[1,], ciF_nest[1,]),
ci_h = c(ciM_nest[2,], ciF_nest[2,]),
time = c(as.numeric(rownames(meanM_nest)), as.numeric(rownames(meanF_nest))),
stage = "Nestling")
ciAll_sex <- rbind(ciInc_sex, ciNest_sex)
# Chunk 19
plotInc_sex <- ggplot(data = ciInc_sex) +
geom_point(aes(x = time, y = mean, color = sex, group = sex),
position = position_dodge(width=0.75)) +
geom_errorbar(aes(x=time, ymax = ci_h, ymin=ci_l, color = sex,
group = sex),
position = position_dodge(width=0.75)) +
labs(x = "Time After Sunset (minutes)", y = "Mean Prey Deliveries",
title = "Incubation", color = "Sex") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 20
plotNest_sex <- ggplot(data = ciNest_sex) +
geom_point(aes(x = time, y = mean, color = sex, group = sex),
position = position_dodge(width=0.75)) +
geom_errorbar(aes(x=time, ymax = ci_h, ymin=ci_l, color = sex,
group = sex),
position = position_dodge(width=0.75)) +
labs(x = "Time After Sunset (minutes)", y = "Mean Prey Deliveries",
title = "Nestling", color = "Sex") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 21
grid.arrange(plotInc_sex, plotNest_sex)
# Chunk 22
t.test(meanF_inc$F_incubation, meanM_inc$M_incubation)
# Chunk 23
t.test(meanF_nest$F_nestling, meanM_nest$M_nestling)
# Chunk 24
pdHM <- pdClean %>%
filter(study_site == "B" | study_site == "C", sex == "M")
# Chunk 25
#create independet dfs for HFSA (nestling and incubation stage) and MGSA (nestling and incubation state).
#select relevant columns, add column for stage, rename study sites, drop NAs
pdStage <- pdClean %>%
dplyr::select(study_site, nest_age, t15:t240) %>%
mutate(
stage =
ifelse(nest_age < 22, "incubation", "nestling"),
study_site =
ifelse(study_site == "B", "MGSA", "HFSA")) %>%
drop_na(stage)
#change column names to remove "t" in front of time interval
colnames(pdStage) <- c("study_site", "nest_age", "15", "30", "45", "60", "75", "90", "105", "120", "135", "150", "165", "180", "195", "210", "225", "240", "stage")
#create independent dfs for each study site and stage
pdHFSA_inc <- pdStage %>%
filter(study_site =="HFSA", stage == "incubation") %>%
dplyr::select('15':'240')
pdHFSA_nest <- pdStage %>%
filter(study_site =="HFSA", stage == "nestling") %>%
dplyr::select('15':'240')
pdMGSA_inc <- pdStage %>%
filter(study_site =="MGSA", stage == "incubation") %>%
dplyr::select('15':'240')
pdMGSA_nest <- pdStage %>%
filter(study_site =="MGSA", stage == "nestling") %>%
dplyr::select('15':'240')
# Chunk 26
meanHFSA_inc <- data.frame(
time = as.numeric(colnames(pdHFSA_inc)),
HFSA_incubation = colMeans(pdHFSA_inc, na.rm = TRUE))
meanHFSA_nest <- data.frame(
time = as.numeric(colnames(pdHFSA_nest)),
HFSA_nestling = colMeans(pdHFSA_nest, na.rm = TRUE))
meanMGSA_inc <- data.frame(
time = as.numeric(colnames(pdMGSA_inc)),
MGSA_incubation = colMeans(pdMGSA_inc, na.rm = TRUE))
meanMGSA_nest <- data.frame(
time = as.numeric(colnames(pdMGSA_nest)),
MGSA_nestling = colMeans(pdMGSA_nest, na.rm = TRUE))
# Chunk 28
meanAll <- data.frame(
time = as.numeric(colnames(pdHFSA_inc)),
HFSA_incubation = colMeans(pdHFSA_inc, na.rm = TRUE),
HFSA_nestling = colMeans(pdHFSA_nest, na.rm = TRUE),
MGSA_incubation = colMeans(pdMGSA_inc, na.rm = TRUE),
MGSA_nestling = colMeans(pdMGSA_nest, na.rm = TRUE)
)
# Chunk 29
#now apply it across the columns of PD data
ciHFSA_inc <- apply(pdHFSA_inc, 2, FUN = getCI)
ciHFSA_nest <- apply(pdHFSA_nest, 2, FUN = getCI)
ciMGSA_inc <- apply(pdMGSA_inc, 2, FUN = getCI)
ciMGSA_nest <- apply(pdMGSA_nest, 2, FUN = getCI)
# Chunk 30
ciInc <- filter(
data.frame(
study_area = c(rep("HFSA", nrow(meanHFSA_inc)), rep("MGSA", nrow(meanMGSA_inc))),
mean = c(colMeans(pdHFSA_inc, na.rm = TRUE), colMeans(pdMGSA_inc, na.rm = TRUE)),
ci_l = c(ciHFSA_inc[1,], ciMGSA_inc[1,]),
ci_h = c(ciHFSA_inc[2,], ciMGSA_inc[2,]),
time = c(as.numeric(rownames(meanHFSA_inc)), as.numeric(rownames(meanMGSA_inc))),
stage = "Incubation"),
time <= 180)
ciNest <- data.frame(
study_area = c(rep("HFSA", nrow(meanHFSA_nest)), rep("MGSA", nrow(meanMGSA_nest))),
mean = c(colMeans(pdHFSA_nest, na.rm = TRUE), colMeans(pdMGSA_nest, na.rm = TRUE)),
ci_l = c(ciHFSA_nest[1,], ciMGSA_nest[1,]),
ci_h = c(ciHFSA_nest[2,], ciMGSA_nest[2,]),
time = c(as.numeric(rownames(meanHFSA_nest)), as.numeric(rownames(meanMGSA_nest))),
stage = "Nestling")
ciAll <- rbind(ciInc, ciNest)
# Chunk 31
plotInc <- ggplot(data = ciInc) +
geom_point(aes(x = time, y = mean, color = study_area, group = study_area),
position = position_dodge(width=0.75)) +
geom_errorbar(aes(x=time, ymax = ci_h, ymin=ci_l, color = study_area,
group = study_area),
position = position_dodge(width=0.75)) +
labs(x = "Time After Sunset (minutes)", y = "Mean Prey Deliveries",
title = "Incubation", color = "Study Area") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 32
plotNest <- ggplot(data = ciNest) +
geom_point(aes(x = time, y = mean, color = study_area, group = study_area),
position = position_dodge(width=0.75)) +
geom_errorbar(aes(x=time, ymax = ci_h, ymin=ci_l, color = study_area,
group = study_area),
position = position_dodge(width=0.75)) +
labs(x = "Time After Sunset (minutes)", y = "Mean Prey Deliveries",
title = "Nestling", color = "Study Area") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 33
plotAll <- ggplot(data = ciAll) +
geom_point(aes(x = time, y = mean, color = study_area, group = study_area),
position = position_dodge(width=0.75)) +
geom_errorbar(aes(x=time, ymax = ci_h, ymin=ci_l, color = study_area,
group = study_area),
position = position_dodge(width=0.75)) +
labs(x = "Time After Sunset (minutes)", y = "Mean Prey Deliveries",
title = "Average Prey Deliveries Throughout Night", color = "Study Area") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
facet_grid(~ stage)
# Chunk 34
grid.arrange(plotInc, plotNest)
# Chunk 35
t.test(meanInc$HFSA_incubation, meanInc$MGSA_incubation)
# Chunk 36
t.test(meanNest$HFSA_nestling, meanNest$MGSA_nestling)
View(meanHFSA_inc)
t.test(meanHFSA_inc$HFSA_incubation, meanMGSA_inc$MGSA_incubation)
t.test(meanHFSA_nest$HFSA_nestling, meanMGSA_nest$MGSA_nestling)
getwd()
pdOriginal <- read.csv("./data/pd_main.csv")
pdOriginal <- read.csv("./data/pd_main.csv/")
getwd()
